<!-- views/admin/order-details.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('../partials/head', { title: 'Order Details | ShopCart' }) %>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

   
  </style>
</head>
<body>
  <%- include('../partials/navbar') %>

  <div class="order-container">
    <!-- Left: Product Card -->
    <div class="card">
      <div class="product-info mb-3">
        <img src="<%= order.product.image %>" alt="Product"  class="product-img">
        <div class="product-details">
          <h3><%= order.product.name %></h3>
          <p>Quantity: <%= order.quantity %></p>
          <input type="hidden" id="orderId" value="<%= order._id %>">
         
          <p>Order ID: <%= order.orderId %></p>
          <p >User ID: <%= order.userId %></p>
           <p><b>Current Status:</b> <%= order.status %></p>
        </div>
      </div>
        <div class="status-buttons mt-4">
         <% if(order.status !== "cancelled" || order.status !== "returned"){ %>
          <p><b>Change the status:</b></p>
          <%}%>
        <% if(order.status === "pending" || order.status === "placed"){ %>
          <button class="btn btn-primary" id="shipped">Shipped</button>
        <% } else if(order.status === "shipped"){ %>
          <button class="btn btn-warning" id="out-for-delivery">Out For Delivery</button>
        <% } else if(order.status === "out-for-delivery"){ %>
          <button class="btn btn-success" id="delivered">Delivered</button>
        <% } else if(order.status === "delivered"){ %>
          <p class="text-success fw-bold">✅ Order Delivered</p>
        <% } else if(order.status === "cancelled"){ %>
          <p class="text-danger fw-bold">❌ Order Cancelled</p>
        <% } else if(order.status === "returned"){ %>
          <p class="text-warning fw-bold">↩️ Order Returned</p>
        <% } %>
      </div>
    </div>

    <!-- Right: Details -->
    <div>
      <div class="card">
        <h4>Shipping Details</h4>
        <p><%= order.address.name %></p>
        <p><%= order.address %></p>
      </div>

      <div class="card" style="margin-top: 15px;">
        <h4>Price Details</h4>
        <p>Price (1 item): ₹<%= order.price %></p>
        <p>Delivery Charges: <span style="color: green;">FREE</span></p>
        <p>Platform fee: 0</p>
      </div>
    </div>
  </div>
     <footer class="text-center py-4 small text-muted border-top mt-4" style="font-weight: 700;">
        © 2025 | ShopCart | All Rights Reserved. | We Give You Style.
        </footer>>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <%- include ('../partials/successAlert') %>
<script>
document.getElementById('shipped')?.addEventListener('click', () => {
   const orderId = document.getElementById('orderId').value;
   window.location.href = `/admin/changeStatus/${orderId}/shipped`;
});

document.getElementById('out-for-delivery')?.addEventListener('click', () => {
   const orderId = document.getElementById('orderId').value;
   window.location.href = `/admin/changeStatus/${orderId}/out-for-delivery`;
});
document.getElementById('delivered')?.addEventListener('click', () => {
   const orderId = document.getElementById('orderId').value;
   window.location.href = `/admin/changeStatus/${orderId}/delivered`;
});

</script>
</html>
