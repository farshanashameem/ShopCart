<!-- orders.ejs -->
<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head', { title: 'ShopCart - My Orders' }) %>
        <style>
            body {
                font-family: Arial, sans-serif;
                background-color: #f8f9fa !important;
            }
        </style>
</head>

<body>
    <%- include('../partials/navbar') %>

        <div class="container my-5">
            <h2 class="mb-4">My Orders</h2>

            <!-- Loop through orders -->
            <% orders.forEach(order=> { %>
                <div class="order-card">
                    <!-- Order Item -->
                    <div class="order-item">
                        <img src="<%= order.image %>" alt="<%= order.name %>">
                        <div class="order-info">
                            <h5>
                                <%= order.name %>
                            </h5>
                            <p>Quantity: <%= order.quantity %> | â‚¹<%= order.price %>
                            </p>
                        </div>
                    </div>

                    <!-- Tracking Bar -->
                    <div class="track">
                            <div class="step <%= ['placed','shipped','out-for-delivery','delivered'].includes(order.status) ? 'active' : '' %>">
                                <div class="circle"></div>
                                <p>Order Placed</p>
                                <small><%= order.statusDates.placed ? order.statusDates.placed.toDateString() : '' %></small>
                            </div>

                            <div class="step <%= ['shipped','out-for-delivery','delivered'].includes(order.status) ? 'active' : '' %>">
                                <div class="circle"></div>
                                <p>Shipped</p>
                                <small><%= order.statusDates.shipped ? order.statusDates.shipped.toDateString() : '' %></small>
                            </div>

                            <div class="step <%= ['out-for-delivery','delivered'].includes(order.status) ? 'active' : '' %>">
                                <div class="circle"></div>
                                <p>Out for Delivery</p>
                                <small><%= order.statusDates["out-for-delivery"] ? order.statusDates["out-for-delivery"].toDateString() : '' %></small>

                            </div>

                            <div class="step <%= order.status === 'delivered' ? 'active' : '' %>">
                                <div class="circle"></div>
                                <p>Delivered</p>
                                <small><%= order.statusDates.delivered ? order.statusDates.delivered.toDateString() : '' %></small>
                            </div>
                    </div>


                    <!-- Buttons -->
                    <div class="d-flex justify-content-end">
                        <% if(order.status==='placed' ){ %>
                            <button class="btn-cancel">Cancel Order</button>
                            <% } else if(order.status==='delivered' ){ %>
                                <button class="btn-return">Return</button>
                                <% } %>
                    </div>
                </div>
                <% }) %>

                    <div class="pagination">
                        <% if (currentPage> 1) { %>
                            <a href="?page=<%= currentPage - 1 %>">Prev</a>
                            <% } %>

                                <% for (let i=1; i <=totalPages; i++) { %>
                                    <a href="?page=<%= i %>" class="<%= i === currentPage ? 'active' : '' %>">
                                        <%= i %>
                                    </a>
                                <% } %>

                                        <% if (currentPage < totalPages) { %>
                                            <a href="?page=<%= currentPage + 1 %>">Next</a>
                                        <% } %>
                    </div>

        </div>

        <%- include('../partials/footer') %>
</body>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</html>