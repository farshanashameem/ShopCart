<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head', { title: 'Home - ShopCart' }) %>

    <body>
        <%- include('../partials/navbar') %>

            <div class="profile-container m-4">
                <div class="row">
                    <!-- Hamburger button for small screens -->
                    <button class="btn btn-dark d-md-none mb-3" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#userSidebar" aria-controls="userSidebar">
                        <i class="bi bi-list"></i> Menu
                    </button>

                    <!-- Sidebar -->
                    <div class="offcanvas offcanvas-start d-md-flex flex-column user-dashboard p-0" tabindex="-1"
                        id="userSidebar">
                        <!-- Header for mobile close button -->
                        <div class="offcanvas-header d-md-none">
                            <h5 class="offcanvas-title">Menu</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
                        </div>
                        <div class="offcanvas-body p-0">
                            <div class="user-greeting mb-3">
                                <div class="image "><img src="images/admin.png" class="profile-image border-round"
                                        alt=""></div>
                                Hello Farshana
                            </div>
                            <ul class="nav flex-column user-list">
                                <li class="nav-item current">
                                    <i class="bi bi-person-circle me-3"></i>
                                    <a href="/profile" class="text-decoration-none bg-transparent">Profile</a>
                                </li>
                                <li class="nav-item mb-3">
                                    <i class="bi bi-card-checklist me-3"></i>
                                    <a href="/orders" class="text-decoration-none bg-transparent">My Orders</a>
                                </li>
                                <li class="nav-item mb-3">
                                    <i class="bi bi-wallet-fill me-3"></i>
                                    <a href="/wallet" class="text-decoration-none bg-transparent">Wallet</a>
                                </li>
                                 <li class="nav-item mb-3">
                                    <i class="bi bi-person-vcard me-3"></i>
                                    <a href="/address" class="text-decoration-none bg-transparent">Address</a>
                                </li>
                                <li class="nav-item mb-3">
                                    <i class="bi bi-cash-coin me-3"></i>
                                    <a href="/referCode" class="text-decoration-none bg-transparent">Refer and Earn</a>
                                </li>
                                <li class="nav-item mb-3">
                                    <i class="bi bi-person-x me-3"></i>
                                    <a href="#" class="text-decoration-none bg-transparent">Delete Account</a>
                                </li>
                                <li class="nav-item mb-3">
                                    <i class="bi bi-box-arrow-left me-3"></i>
                                    <a href="/logout" class="text-decoration-none bg-transparent">Logout</a>
                                </li>
                            </ul>
                        </div>
                    </div>


                    <div class="profile-card">
                        <h2 class="profile-title">PROFILE</h2>
                        <!-- Form -->
                        <form class="profile-form" method="post" action="/profileUpdate" enctype="multipart/form-data">
                            <!-- Avatar -->
                            <div class="avatar-container">
                                <img src="<%= user.image  %>" alt="Profile Picture" class="avatar-img"
                                    id="profileImage">

                                <label for="avatarUpload" class="avatar-upload">
                                    <i class="bi bi-camera-fill"></i>
                                </label>

                                <input type="file" name="profileImage" id="avatarUpload" accept="image/*" hidden>
                            </div>

                            <div class="form-group">
                                <label>Name:</label>
                                <div class="input-wrapper">
                                    <input type="text" name="name" value="<%=old?.name?old.name: user.name%>" readonly>
                                    <i class="bi bi-pencil-fill edit-icon"></i>
                                </div>
                                <% if (errors?.name) { %>
                                    <p class="text-danger m-0">
                                        <%= errors.name %>
                                    </p>
                                    <% } %>
                            </div>

                            <div class="form-group">
                                <label>Email:</label>
                                <div class="input-wrapper">
                                    <input type="email" name="email" value="<%= old?.email ? old.email : user.email %>"readonly>
                                    <i class="bi bi-pencil-fill edit-icon"></i>
                                </div>
                                <% if (errors?.email) { %>
                                    <p class="text-danger m-0">
                                        <%= errors.email %>
                                    </p>
                                    <% } %>
                            </div> 

                            <div class="form-group">
                                <label>Phone:</label>
                                <div class="input-wrapper">
                                    <input type="tel" name="phone" value="<%=old?.phone?old.phone: user.mobile %>" readonly>
                                    <i class="bi bi-pencil-fill edit-icon"></i>
                                </div>
                                <% if (errors?.phone) { %>
                                    <p class="text-danger m-0">
                                        <%= errors.phone %>
                                    </p>
                                    <% } %>
                            </div>



                            <a href="/updatePassword" class="change-password bg-light ">Change password</a>
                            <button type="submit" class="save-btn">Save changes</button>

                        </form>
                    </div>

                </div>
            </div>


            <%- include('../partials/footer') %>
                <!-- Bootstrap Bundle with Popper -->
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
                <script src="/js/profileEdit.js"></script>
    </body>

</html>